<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Personal Website</title>
        <link rel="stylesheet" href="/style.css">
        <script src="/script.js"></script>
    </head>

    <body>
        <div class="crt"></div>

        <div class="vignette"></div>
        <div class="global-container">

            <div class="container">
                <header>
                    <h2>system.cfg</h2>
                </header>
                <button class="toggle-btn active" id="crtToggle">CRT</button>
                <button class="toggle-btn active" id="vignetteToggle">Vignette</button>
                <button class="toggle-btn active" id="backgroundToggle">Background</button>
            </div>

            <div class="container">
                <header>
                    <h2>cat about.txt</h2>
                </header>
                <p>
                    Hello there! Welcome to my website where I showcase some of my projects and fun ideas. Browse through the files to discover more about my work. If you have any questions or just want to chat, feel free to reach out. Enjoy your time here!
                </p>
            </div>

            <div class="container">
                <header>
                    <h2>ls -la ~/projects/</h2>
                    <div class="cache-status" id="cache-status" style="display: none;">
                        <small style="opacity: 0.7;"></small>
                        <button id="refresh-btn" style="margin-left: 10px; font-size: 0.8em;">↻ Refresh</button>
                    </div>
                </header>
                <div id="projects-loading" class="loading-state">
                    <p>Loading projects from GitHub...</p>
                </div>
                <div id="projects-error" class="error-state" style="display: none;">
                    <p>Failed to load projects. <button id="retry-btn">Retry</button></p>
                </div>
                <table id="projects-table" style="display: none;">
                    <tbody id="projects-tbody">
                        <!-- Projects will be loaded here dynamically -->
                    </tbody>
                </table>
            </div>

            <div class="container">
                <header>
                    <h2>cat social_links.md</h2>
                </header>
                <table>
                    <tbody>
                        <tr>
                            <td><strong>GitHub</strong></td>
                            <td>
                                <a href="https://github.com/frostplexx" target="_blank" rel="noopener noreferrer">@frostplexx</a>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Email</strong></td>
                            <td><a href="mailto:me@dinama.dev">me@dinama.dev</a></td>
                        </tr>
                        <tr>
                            <td><strong>Discord</strong></td>
                            <td><a href="https://discordapp.com/users/336806197158215682">Frostplexx</a></td>
                        </tr>
                        <!-- <tr> -->
                        <!--     <td><strong>Matrix</strong></td> -->
                        <!--     <td><a href="https://matrix.to/#/@frostplexx:matrix.org">@frostplexx:matrix.org</a></td> -->
                        <!-- </tr> -->
                        <!-- <tr> -->
                        <!--     <td><strong>Mastodon</strong></td> -->
                        <!--     <td><a href="https://fosstodon.org/@frostplexx">@frostplexx@fosstodon.org</a></td> -->
                        <!-- </tr> -->
                    </tbody>
                </table>
            </div>

            <div class="container">
                <header>
                    <h2>cat ~/.config/tools.json</h2>
                </header>
                <p>Some tools I like using:</p>
                <table>
                    <ul>
                        <li><a href="https://obsidian.md">Obsidian Notes</a> – Local first note taking app</li>
                        <li><a href="https://neovim.io">NeoVim</a> – Fast, hackable text editor</li>
                    </ul>
                </table>
            </div>

            <div class="container">
                <header>
                    <h2>uptime --since</h2>
                </header>
                <p>
                    <strong>Current Focus:</strong> Building resilient infrastructure and contributing to open-source projects<br>
                    <strong>Learning:</strong> Advanced Kubernetes patterns, WebAssembly, and distributed systems<br>
                    <strong>Fun Fact:</strong> I maintain 47 different dotfiles that somehow still work across 3 different machines ¯\_(ツ)_/¯
                </p>
            </div>

            <div class="container">
                <header>
                    <h2>./fun</h2>
                </header>
                <p>
                    <a href="/doom/doom.html"><strong>Want to play some DOOM?</strong></a><br>
                    <a href="/cats/cats.html"><strong>Cat</strong></a><br>
                </p>
            </div>

            <footer>
                <p>
                    <a href="https://fediring.net/previous?host=dinama.dev">←</a>
                    <a href="https://fediring.net/">Fediring</a>
                    <a href="https://fediring.net/next?host=dinama.dev">→</a>
                </p>
                <p>
                    Source available on <a href="https://github.com/frostplexx/dinama-web">GitHub</a>
                </p>
            </footer>
        </div>
        <canvas class="background" width="512" height="512">
            Your browser does not support canvas.
        </canvas>

        <script>
            // GitHub Projects Loading
            async function loadProjects() {
                const loadingEl = document.getElementById('projects-loading');
                const errorEl = document.getElementById('projects-error');
                const tableEl = document.getElementById('projects-table');
                const tbodyEl = document.getElementById('projects-tbody');

                try {
                    loadingEl.style.display = 'block';
                    errorEl.style.display = 'none';
                    tableEl.style.display = 'none';

                    const response = await fetch('/api/github');
                    const data = await response.json();

                    if (!data.success) {
                        throw new Error(data.message || 'Failed to fetch projects');
                    }

                    // Clear existing content
                    tbodyEl.innerHTML = '';

                    // Populate projects
                    data.projects.forEach(project => {
                        const row = document.createElement('tr');
                        
                        // Format date
                        const date = new Date(project.updatedAt).toLocaleDateString('en-US', {
                            month: 'short',
                            day: '2-digit',
                            year: 'numeric'
                        });

                        // Status badge class
                        const statusClass = project.status.toLowerCase().replace('_', '-');
                        
                        // Tech stack display
                        const techStack = project.techStack.join(' • ');

                        row.innerHTML = `
                            <td>-rwxr-xr-x</td>
                            <td>daniel</td>
                            <td>${date}</td>
                            <td>
                                <a href="${project.url}" target="_blank" rel="noopener noreferrer">${project.name}</a>
                                <span class="status-badge status-${statusClass}">${project.status}</span><br>
                                <div class="project-description">${project.description}</div>
                                <div class="tech-stack">${techStack}</div>
                            </td>
                        `;
                        
                        tbodyEl.appendChild(row);
                    });

                    loadingEl.style.display = 'none';
                    tableEl.style.display = 'table';

                } catch (error) {
                    console.error('Error loading projects:', error);
                    loadingEl.style.display = 'none';
                    errorEl.style.display = 'block';
                }
            }

            // Retry functionality
            document.getElementById('retry-btn').addEventListener('click', loadProjects);

            // Load projects when page loads
            document.addEventListener('DOMContentLoaded', loadProjects);
        </script>
    </body>
</html>
